# 物理层

物理层考虑的事如何在连接各台计算机的传输媒体上传输**数据比特流**，确定传输媒体接口有关的**特性**。

1. 机械特性：引线数量，引脚数量

   物理上面各种接口的形式

2. 电气特性：电压范围，传输速率，距离限制

   客观电气特点

3. 功能特性：某一电平表示的意义

   主观上对客观事物赋予的意义

4. 规程特性：工作规程以及时序

   各种功能的具体实现

## 概念

### 数据、信号、码元

信号：数据在传输过程中的存在形式

数据：传送信息的实体

- 模拟数据：连续变化的数据
- 数字数据：有限的离散数值的数据

码元：固定时长的信号波长，可以理解为电平

> 曼彻斯特编码中一个周期需要两个电平，那就是两个码元
>
> 非归零编码中一个周期只需要一个电平，那就是一个码元

### 码元和比特的区别

一个$n$进制码元能够携带$log_2n$数量的比特

#### 举例

一个数字发射器能够发送$+1V,+2V,+3V,+4V$的电压信号，这每一个信号都是一个码元，每个码元在被接收器接收到之后将被翻译成为$00,01,10,11$的数值。以上就是一个比较经典的**四进制码元**例子。

### 速率，波特，带宽

速率指的是单位时间内传输的数据量，分为**码元传输速率**以及**信息传输速率**。

1. 码元传输速率：单位时间内数字通信系统能够传输的**码元**数量（$Baud$），波特率。
2. 信息传输速率：单位时间内数字通信系统能够传输的**比特**数量（$b/s$）。

#### 码元传输速率与信息传输速率的转换关系

假设码元的为$k$进制，那么的话$信息传输速率=log_2k*码元传输速率$

### 信源、信道、信宿

数据通信系统主要划分为**信源**、**信道**以及**信宿**三个部分。

信源：产生和发送数据的**源头**。

信宿：接受数据的**终点**。

信道：信号的传输**媒介**。

一个信道包含**发送信道**和**接受信道**，包含用于通信的电路。

#### 按照传送信号形式分类

模拟信道：传送模拟信号

数字信道：传送数字信号

#### 按照传输介质分类

无线信道：没有固定链路的信道，例如无线电等形式

有线信道：有固定链路的信道，例如光纤

## 两个重要定理

将介绍两个在不同情况下计算**极限数据传输速率**的定理。

### 奈奎斯特定理

背景：信号中的高频分量往往不能通过信道，这种现象称为**码间串扰**。

**奈奎斯特定理**：在**理想低通**（没有噪声，带宽有限）的信道中，极限码元传输速率是$2W$波特

> $W$指的是理想低通信道带宽，这里的带宽指的是

同时设一个每个码元的离散电平的数量为$V$

那么的话我们就够得到理想低通信道下的极限数据传输速率为
$$
2Wlog_2V
$$
也就是极限码元传输速率乘以每个码元携带的比特数量

关于奈奎斯特定理给出以下**结论**：

1. 任何信道中**码元**传输速率是有上限的。
2. **频带**越宽码元的**最高传输速率**也越高。
3. 奈奎斯特定理之给出了**码元传输速率**的限制而没有给出**信息传输速率**的限制。

### 香农定理

在**低通**（有高斯白噪声，带宽受限）的信道中，信道的极限传输速率为
$$
Wlog_2(1+\frac{S}{N})
$$

> $W$：信道带宽
>
> $S$：信道所传输信号的平均功率
>
> $N$：信道内部的高斯噪声的功率

#### 信噪比分别

书本上定义了两个信噪比，两者在概念上比较接近容易混淆

1. 信号的平均功率以及噪声的平均功率的比值，$\frac{S}{N}$，没有单位
2. 以$dB$为单位但仍然叫信噪比，主要目的是为减少科学计数法带来的不便，$10log_{10}(S/N)$

我们主要的分辨方式就是通过其单位以及值的大小来分辨

可以发现的是**信道的极限传输速率**以及**信噪比**在明确信道带宽的情况下能够相互计算。

关于香农定理我们能够给出以下结论：

1. 信道的**带宽**以及**信噪比**一定的情况下信道的极限传输速率一定
2. 信道的**带宽**或者**信噪比**越多那么信道的极限传输速率也越大
3. 香农定理得出的是极限信息传输速率，**实际**信道能够达到的传输速率要比他低不少
4. 只要信息传输速率低于信道的极限传输速率那么久存在某种方式进行**无差错传输**

### 奈氏定理以及香农定理实际使用

分别查看两个定理的使用条件是否满足（有无高斯噪声）以及计算元素是否满足，如果同时满足采用较小值

> 奈氏定理：带宽，编码进制
>
> 香农定理：带宽，信噪比，环境噪声

## 编码与调制

编码：把数据变成数字信号

调制：把数据变成模拟信号

**数字信道**传输**基带信号**。

**模拟信道**传输**宽带信号**。

### 将数字数据编码为数字信号

使用**数字发送器**

1. 非归零编码

   $0$就是$0$，$1$就是$1$

   对于连续的$0\ 1$无法传递时钟信号来同步

2. 归零编码

   每个时钟周期的中间均跳变到**低电平**

   对于连续的$0$无法依然无法传递时钟信号

3. 反向非归零编码

   用信号的翻转来代表$0$不翻转代表$1$

4. 曼彻斯特编码

   将一个码元分割成两个相等的间隔

   码元$1$：前一个间隔为高电平后一个间隔为低电平

   码元$0$：前一个间隔为低电平后一个间隔为高电平

   中间出现**跳变**能够作为**时钟信号**，也能够作为**数据信号**。

   频带宽度是原始基带宽度的两倍，数据传输速率只有调制速率的一半。

   > 以太网使用曼彻斯特编码

5. 差分曼彻斯特编码

   码元$1$：前一个码元和后一个码元不同

   码元$0$：前一个码元和后一个码元相同

   每个码元中间都有一个跳变能够自同步，同时抗干扰性好。

6. $4B/5B$编码

   将要发送的数据$4$个为一组转化为对应的$5$位码，接受到后再进行转化。

   编码效率为$80\%$

### 数字数据调制为模拟信号

使用**调制器**

调制：数字数据调制技术在**发送**端将**数字信号**转换为**模拟信号**

解调：数字数据调制技术在**接收**端将**模拟信号**还原为**数字信号**

1. 调幅（$ASK$）

   改变载波信号的**振幅**

2. 调频（$FSK$）

   改变载波信号的**频率**

3. 调相（$PSK$）

   改变载波信号的**相位**

4. $QAM$

   同时改变载波信号的**振幅**和**相位**

### 模拟数据编码为数字信号

使用**$PCM$编码器**

1. 采样

   将时间上**连续**的信号变为时间上**离散**的信号

   采样频率$f_{采样}$和最大频率$f_{max}$的关系
   $$
   f_{采样}=f_{max}*2
   $$

2. 量化

   按照一定的分级制度转化为对应的**数字值**并取整

3. 编码

   将量化结果转换为对应的**二进制编码**

举例：转化存储音频数据

### 模拟数据调制为模拟信号

使用**放大器调制器**

为了实现传输的有效性，需要将**低频信息**转化为**高频信息**。

举例：传播声音数据，声音频率较低，如果需要转化就要转化为高频电磁信号。

## 三种交换技术

### 电路交换

需要在两个节点之间建立一条专用的无力通信路径，最大的特点是**独占资源**

三个阶段：**连接建立**，**数据传输**，**连接释放**

#### 优点

1. 通信时延小

   专用链路，数据直达

2. 有序传输

   按顺序发送数据，不会失序

3. 没有冲突

   双方使用不同信道，没有第三方

4. 实时性强

   链路建立之后双方随时通信

#### 缺点

1. 建立连接时间长

2. 线路独占，使用效率低

3. 灵活性差

4. 难以规格化

   不同类型、不同规格、不同速率的终端**很难相互进行通信**，通信过程中也不能进行**差错控制**

### 报文交换

数据交换单位是**报文**，报文携带目标地址、原地址等信息。报文交换在交换节点采用**存储转发**的传输方式。

#### 优点

1. 无需建立连接

   与**电路交换**主要区别

2. 动态分配线路

3. 提高线路可行性

4. 提高线路利用率

5. 提供多目标服务

   可以有多个**目的地址**

#### 缺点

1. 每个节点都有存储转发这个过程，会引起**转发时延**
2. 报文交换大小没有限制，对网络节点需要较大**缓存空间**

### 分组交换

把大的数据块划分为小数据块，采用**存储转发**的方式

#### 优点

1. 无建立时延

   不需要预先建立一条专用的通信线路

2. 线路利用率高

   不固定占用一条线路，提高通信线路的利用率

3. 简化了存储管理

   分组长度固定，那么的相应的缓冲区大小也固定

4. 线路可靠性高

   动态分配线路

#### 缺点

1. 存在转发时延

   比较报文交换时延小，但比较电路交换时延大

2. 报文头信息开销加大

   每个小数据块都要额外加上一个报文头信息

3. 容易出现失序问题，需要重新排序


#### 分类

主要分为**数据报**方式和**虚电路**方式

### 三种交换技术比较

要传送的**数据量很大**同时**传送时间远大于呼叫时间**时，采用**电路交换**比较合适。

提高这个网络的**信道利用率**来看，**报文交换**和**分组交换**优于**电路交换**，其中分组交换较报文交换时延小。

## 两种分组交换的方式

主要分为**面向连接**的**虚电路**方式（路径相同）以及**无连接**的**数据报**方式（路径不同）。

### 数据报方式

1. **构建**转发表
2. **检索**转发表
3. 每个分组**独立**选路

#### 数据报和报文交换辨别

数据报：一种无连接的分组交换方式，将报文分成一小块一小块由网络层交付

报文交换：一种区别于分组交换的交换方式，将一整份报文直接由网络层交付

### 虚电路方式

一条源主机到目的主机**类似**于**电路**的路径，路径上所有节点都要维持这条虚电路的建立。

整个过程分为三个阶段：**虚电路建立**、**数据传输**以及**虚电路释放**

#### 工作原理

1. 呼叫请求

   源主机发送一个**呼叫请求**分组，通过中间节点送往目的主机

2. 发送数据

   通过表示虚电路号来进行**全双工通信**

3. 释放请求

   源主机通过发送**释放请求**分组来拆除虚电路

### 两种分组交换方式比较

|                    | 数据报服务                                           | 虚电路服务                             |
| :----------------- | ---------------------------------------------------- | -------------------------------------- |
| 连接的建立         | 不需要                                               | 必需                                   |
| 目的地址           | 每个分组都需要目的地址                               | 只需要较短的虚电路号就行了             |
| 路由选择           | 每个分组都需要独立选择路由                           | 同一个虚电路的分组按照同一路由转发     |
| 分组顺序           | 不保证分组有序到达                                   | 保证分组有序到达                       |
| 可靠性             | 不保证可靠性                                         | 可靠性由网络保证                       |
| 网络故障适应性     | 出故障的节点丢失分组，其余分组路径变化后继续正常传输 | 所有经过故障节点的虚电路都不能正常工作 |
| 差错处理和流量控制 | 由用户主机进行流量控制，不保证数据报可靠性           | 可由分组交换网和用户主机负责           |

只要理解了两者本质上的差异，即一者为**直接分组转发**另一者为**先建立专用通路而后直接发送**就行了。

## 传输介质

也叫传输媒体，是设备与设备之间**物理通路**。

> 逻辑通路：信道

### 导向传输介质

沿着**固体**媒介传播

#### 双绞线

两根**并排绞和**的铜导线组成。

通过有无屏蔽层分为**屏蔽双绞线**和**非屏蔽双绞线**。

可以使用**放大器**放大模拟传输中的**模拟信号**，使用**中继器**放大数字传输中的**数字信号**

#### 同轴电缆

由**导体**、**绝缘层**、**网状编制屏蔽层**以及**塑料外层**构成的**同轴心**电缆。

通过传送的信号类型分为**基带同轴电缆**（数字信号）以及**宽带同轴电缆**（宽带信号）。

特点：抗干扰性好，传输距离远，价格较双绞线贵

#### 光纤

通过**光脉冲**通信，**带宽**较大

##### 通过通过光线数量分类

- 单模光纤（单光线）

  光纤直径缩小到只有一个光的波长时候，光线就能**直线**传播

  损耗**少**，适合**远**距离传播，使用**激光**作为光源

- 多模光纤（多光线）

  利用**全反射**特性传播，损耗较单模**大**，适合**近**距离传播，使用$LED$作为光源

### 非导向传输媒介

沿着**气体**、**液体**或者**真空**传输的介质

#### 无线电波

较强的**穿透能力**，向**所有方向**传播

#### 微波、红外线以及激光

**直线**传播

##### 微波

频带范围宽，容量大，需要中继站接力

##### 红外线、激光

需要将传输的信号转换为各自的信号格式

## 物理层设备

**转发器**，只会**再生**（将衰减的信号还原成原来的样子）

### 中继器

一进一出，两端相同

$5-4-3$原则：$4$个中继器串联$5$段通信介质，其中只有$3$段可以挂接计算机

### 集线器

理解为**多端口**中继器

主要使用双绞线组建**共享网络**，因为不能分割冲突域，所以需要平分带宽
